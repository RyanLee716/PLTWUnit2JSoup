/* @license GPL-2.0-or-later https://www.drupal.org/licensing/faq */
((Drupal,drupalSettings)=>{'use strict';Drupal.behaviors.cta={attach:()=>{var campaignId='default';var campaignSettings=drupalSettings.cta.campaign||{};if(campaignSettings)campaignId=campaignSettings.id;var campaign=JSON.parse(localStorage.getItem(`Drupal.cta.modalBlock.${campaignId}`));var show=true;var now=Math.floor(Date.now()/1000);if(campaign)if(campaign.hide)show=false;else{if(campaign.lastCloseTime)if(campaignId==='default')show=false;else{if(campaignSettings){var elapsedSinceLastClose=now-campaign.lastCloseTime;if(elapsedSinceLastClose<campaignSettings.config.hideDuration)show=false;}}}var modal=document.getElementById('cta-modal-block');var submitForm=modal.querySelector('#edit-submit');var submitLink=modal.querySelector('.cta-modal-block-submit');var event=new Event('show.cta-modal',{cancelable:true});modal.dispatchEvent(event);if(event.defaultPrevented)show=false;function setLastCloseTime(campaignId,data={}){var existingData=localStorage.getItem('Drupal.cta.modalBlock.'+campaignId);var campaign=existingData?JSON.parse(existingData):{};campaign.lastCloseTime=now;campaign=Object.assign(campaign,data);localStorage.setItem('Drupal.cta.modalBlock.'+campaignId,JSON.stringify(campaign));}function handleCloseModal(){modal.style.display='none';setLastCloseTime(campaignId);document.removeEventListener('keydown',handleEscapeKey);}function handleEscapeKey(event){if(event.key==='Escape')handleCloseModal();}if(show){setTimeout(()=>{modal.classList.add('show');},500);modal.style.display='block';if(submitForm)submitForm.addEventListener('click',()=>{setLastCloseTime(campaignId,{hide:1});});if(submitLink)submitLink.addEventListener('click',()=>{setLastCloseTime(campaignId);});document.addEventListener('keydown',handleEscapeKey);var close=document.querySelector('.cta-modal-block-close');close.addEventListener('click',handleCloseModal);}else modal.style.display='none';}};})(Drupal,drupalSettings);;
